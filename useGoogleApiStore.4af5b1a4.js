import{aJ as h,y as s}from"./entry.a79ec5c3.js";const _="https://sheets.googleapis.com/$discovery/rest?version=v4",C="https://www.googleapis.com/auth/spreadsheets",J=h("googleApi",()=>{const[n,S]=[window.gapi,window.google];async function r(e="sessionStorage"){if(e==="sessionStorage"){const l=sessionStorage.getItem("google_api");if(l){const g=JSON.parse(l);t.value=g.apiKey,a.value=g.spreadsheetId,o.value=g.clientId}else t.value="AIzaSyDzuZgo-pF-4be2-vA_Y0VmGUpO5WPNBgA",a.value="1s4Qkqh2CkWGOsK0LCSJ4p_Hwks1ePFpQrrvXKRmAJNw",o.value="";return}}async function d(e="sessionStorage"){if(e==="sessionStorage"){sessionStorage.setItem("google_api",JSON.stringify({apiKey:t.value,spreadsheetId:a.value,clientId:o.value}));return}}async function f(){await r()}const t=s("AIzaSyDzuZgo-pF-4be2-vA_Y0VmGUpO5WPNBgA");function k(e){t.value=e}const a=s("1s4Qkqh2CkWGOsK0LCSJ4p_Hwks1ePFpQrrvXKRmAJNw");function y(e){a.value=e}const o=s(""),A=e=>{o.value=e};s("");const u=s(!1);async function I(){await n.load("client",m)}async function m(){let e=sessionStorage.getItem("google_token")||null;e&&(e=JSON.parse(e)),await n.client.init({apiKey:t.value,discoveryDocs:[_]}),n.client.setToken(e),u.value=!0}async function p(e="sessionStorage"){const l=n.auth.getToken();e==="sessionStorage"&&(sessionStorage.setItem("google_token",JSON.stringify(l)),sessionStorage.setItem("google_token_expires_at",time.toString()))}const c=s(!1),i=s(null);async function w(e){c.value||await v(),i.value.callback=()=>{e(),p()},n.client.getToken()===null?i.value.requestAccessToken({prompt:"consent"}):i.value.requestAccessToken({prompt:""})}async function v(){i.value=await S.accounts.oauth2.initTokenClient({client_id:o.value,scope:C,callback:""}),c.value=!0}return{loadAll:r,saveAll:d,resetAll:f,apiKey:t,setApiKey:k,spreadsheetId:a,setSpreadsheetId:y,clientId:o,setClientId:A,gapiInited:u,loadGapi:I,saveGapiToken:p,requestAccessToken:w,gisInited:c,loadGis:v}});export{J as u};
